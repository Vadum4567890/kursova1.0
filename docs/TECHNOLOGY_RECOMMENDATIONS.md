# üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —â–æ–¥–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π

## –ê–Ω–∞–ª—ñ–∑ –ø–æ—Ç—Ä–µ–± –ø—Ä–æ–µ–∫—Ç—É

### ‚ùå **–ù–ï –ü–û–¢–†–Ü–ë–ù–û –∑–∞—Ä–∞–∑:**

#### 1. **Sessions + Cookies**
**–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è JWT –≤ Authorization header (stateless –ø—ñ–¥—Ö—ñ–¥)

**–ß–æ–º—É –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ:**
- ‚úÖ JWT —Ç–æ–∫–µ–Ω–∏ –ø—Ä–∞—Ü—é—é—Ç—å –¥–æ–±—Ä–µ –¥–ª—è REST API
- ‚úÖ Stateless –ø—ñ–¥—Ö—ñ–¥ –ø—Ä–æ—Å—Ç—ñ—à–∏–π –¥–ª—è –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è
- ‚úÖ –ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Å—Ç–∞–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

**–ö–æ–ª–∏ –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è:**
- –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω logout –∑ blacklist —Ç–æ–∫–µ–Ω—ñ–≤
- –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ HttpOnly cookies –¥–ª—è –∫—Ä–∞—â–æ—ó –±–µ–∑–ø–µ–∫–∏ (–∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ XSS)
- –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ refresh tokens

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –î–ª—è –∫—É—Ä—Å–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É JWT –≤ header –¥–æ—Å—Ç–∞—Ç–Ω—å–æ. –ú–æ–∂–Ω–∞ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ –±–µ–∑–ø–µ–∫—É —á–µ—Ä–µ–∑ HttpOnly cookies –ø—ñ–∑–Ω—ñ—à–µ.

---

#### 2. **Redis**
**–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω:** –ù–µ–º–∞—î –∫–µ—à—É–≤–∞–Ω–Ω—è, –≤—Å—ñ –¥–∞–Ω—ñ –∑ –ë–î

**–ß–æ–º—É –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞—Ä–∞–∑:**
- ‚úÖ –ü—Ä–æ–µ–∫—Ç –Ω–µ–≤–µ–ª–∏–∫–∏–π, –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–µ–≤–µ–ª–∏–∫–µ
- ‚úÖ PostgreSQL –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —à–≤–∏–¥–∫–∏–π –¥–ª—è –ø–æ—Ç–æ—á–Ω–∏—Ö –ø–æ—Ç—Ä–µ–±
- ‚úÖ –î–æ–¥–∞—Ç–∫–æ–≤–∞ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –Ω–µ –≤–∏–ø—Ä–∞–≤–¥–∞–Ω–∞

**–ö–æ–ª–∏ –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è:**
- –ü—Ä–∏ –≤–µ–ª–∏–∫–æ–º—É –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ (1000+ –∑–∞–ø–∏—Ç—ñ–≤/—Å–µ–∫)
- –î–ª—è –∫–µ—à—É–≤–∞–Ω–Ω—è –ø–æ–ø—É–ª—è—Ä–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ (—Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ–≤)
- –î–ª—è rate limiting (–æ–±–º–µ–∂–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤)
- –î–ª—è blacklist —Ç–æ–∫–µ–Ω—ñ–≤ –ø—Ä–∏ logout
- –î–ª—è real-time —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–ª—è –∫—É—Ä—Å–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É. –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ø—ñ–∑–Ω—ñ—à–µ –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó.

---

#### 3. **RabbitMQ (Message Queue)**
**–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω:** Observer pattern —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ

**–ß–æ–º—É –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ:**
- ‚úÖ Observer pattern –ø—Ä–∞—Ü—é—î —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —ñ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ
- ‚úÖ –ù–µ–º–∞—î —Å–∫–ª–∞–¥–Ω–∏—Ö –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏—Ö –∑–∞–¥–∞—á
- ‚úÖ –ù–µ–º–∞—î –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –≤ —á–µ—Ä–≥–∞—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
- ‚úÖ –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —É—Å–∫–ª–∞–¥–Ω—é—î –ø—Ä–æ–µ–∫—Ç

**–ö–æ–ª–∏ –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è:**
- –î–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ email —Å–ø–æ–≤—ñ—â–µ–Ω—å
- –î–ª—è –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –∑–≤—ñ—Ç—ñ–≤ –≤ —Ñ–æ–Ω—ñ
- –î–ª—è –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–Ω–æ—ó –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏
- –î–ª—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–¥—ñ–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–ª—è –∫—É—Ä—Å–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É. Observer pattern –¥–æ—Å—Ç–∞—Ç–Ω—å–æ.

---

## ‚úÖ **–©–æ –ú–û–ñ–ù–ê –ø–æ–∫—Ä–∞—â–∏—Ç–∏ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ):**

### 1. **HttpOnly Cookies –¥–ª—è —Ç–æ–∫–µ–Ω—ñ–≤** (–ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏)

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ XSS –∞—Ç–∞–∫ (JavaScript –Ω–µ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ç–æ–∫–µ–Ω)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ –∑ –∫–æ–∂–Ω–∏–º –∑–∞–ø–∏—Ç–æ–º
- –ë–µ–∑–ø–µ—á–Ω—ñ—à–µ –Ω—ñ–∂ localStorage

**–ù–µ–¥–æ–ª—ñ–∫–∏:**
- –°–∫–ª–∞–¥–Ω—ñ—à–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è CORS
- –ü–æ—Ç—Ä—ñ–±–Ω—ñ CSRF —Ç–æ–∫–µ–Ω–∏

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```typescript
// –í AuthController –ø—Ä–∏ login
res.cookie('token', token, {
  httpOnly: true,
  secure: process.env.NODE_ENV === 'production',
  sameSite: 'strict',
  maxAge: 24 * 60 * 60 * 1000 // 24 –≥–æ–¥–∏–Ω–∏
});
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏, –∞–ª–µ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ.

---

### 2. **Refresh Tokens** (–ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è UX)

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –≤–∏—Ö–æ–¥–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
- –ö–æ—Ä–æ—Ç–∫—ñ access tokens (15 —Ö–≤) + –¥–æ–≤–≥—ñ refresh tokens (7 –¥–Ω—ñ–≤)
- –ë–µ–∑–ø–µ—á–Ω—ñ—à–µ

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
- Access token (–∫–æ—Ä–æ—Ç–∫–∏–π) - –≤ Authorization header
- Refresh token (–¥–æ–≤–≥–∏–π) - –≤ HttpOnly cookie
- Endpoint `/api/auth/refresh` –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –¥–ª—è –∫—Ä–∞—â–æ–≥–æ UX, –∞–ª–µ –Ω–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ.

---

### 3. **Rate Limiting** (–∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ DDoS)

**–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω:** –ù–µ–º–∞—î –æ–±–º–µ–∂–µ–Ω—å –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤

**–ü—Ä–æ—Å—Ç–µ —Ä—ñ—à–µ–Ω–Ω—è –±–µ–∑ Redis:**
```typescript
import rateLimit from 'express-rate-limit';

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 —Ö–≤–∏–ª–∏–Ω
  max: 100 // –º–∞–∫—Å–∏–º—É–º 100 –∑–∞–ø–∏—Ç—ñ–≤
});
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ø—Ä–æ—Å—Ç–∏–π rate limiting –±–µ–∑ Redis.

---

## üìä –ü–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è

| –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—è | –ü–æ—Ç—Ä—ñ–±–Ω–∞? | –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å | –ö–æ—Ä–∏—Å—Ç—å –¥–ª—è –ø—Ä–æ–µ–∫—Ç—É |
|------------|-----------|------------|---------------------|
| **Sessions** | ‚ùå –ù—ñ | –°–µ—Ä–µ–¥–Ω—è | –ù–∏–∑—å–∫–∞ (JWT –¥–æ—Å—Ç–∞—Ç–Ω—å–æ) |
| **Cookies (HttpOnly)** | ‚ö†Ô∏è –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ | –ù–∏–∑—å–∫–∞ | –°–µ—Ä–µ–¥–Ω—è (–±–µ–∑–ø–µ–∫–∞) |
| **Redis** | ‚ùå –ù—ñ | –í–∏—Å–æ–∫–∞ | –ù–∏–∑—å–∫–∞ (–º–∞–ª–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è) |
| **RabbitMQ** | ‚ùå –ù—ñ | –î—É–∂–µ –≤–∏—Å–æ–∫–∞ | –ù–∏–∑—å–∫–∞ (–Ω–µ–º–∞—î –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏—Ö –∑–∞–¥–∞—á) |
| **Rate Limiting** | ‚ö†Ô∏è –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ | –ù–∏–∑—å–∫–∞ | –°–µ—Ä–µ–¥–Ω—è (–∑–∞—Ö–∏—Å—Ç) |

---

## üéØ –í–∏—Å–Ω–æ–≤–æ–∫

### –î–ª—è –∫—É—Ä—Å–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É:
- ‚úÖ **JWT –≤ Authorization header** - –¥–æ—Å—Ç–∞—Ç–Ω—å–æ
- ‚úÖ **PostgreSQL** - –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–ª—è –¥–∞–Ω–∏—Ö
- ‚úÖ **Observer pattern** - –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–ª—è —Å–ø–æ–≤—ñ—â–µ–Ω—å
- ‚ùå **Redis** - –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ (overkill)
- ‚ùå **RabbitMQ** - –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ (overkill)
- ‚ùå **Sessions** - –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ (JWT –∫—Ä–∞—â–µ –¥–ª—è REST API)

### –ú–æ–∂–Ω–∞ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ):
- ‚ö†Ô∏è **HttpOnly Cookies** - –¥–ª—è –∫—Ä–∞—â–æ—ó –±–µ–∑–ø–µ–∫–∏
- ‚ö†Ô∏è **Refresh Tokens** - –¥–ª—è –∫—Ä–∞—â–æ–≥–æ UX
- ‚ö†Ô∏è **Rate Limiting** - –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ DDoS

### –ö–æ–ª–∏ –∑–Ω–∞–¥–æ–±–ª—è—Ç—å—Å—è:
- **Redis** - –ø—Ä–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ 1000+ –∑–∞–ø–∏—Ç—ñ–≤/—Å–µ–∫ –∞–±–æ –¥–ª—è –∫–µ—à—É–≤–∞–Ω–Ω—è
- **RabbitMQ** - –ø—Ä–∏ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–Ω—ñ–π –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—ñ –∞–±–æ —Å–∫–ª–∞–¥–Ω–∏—Ö –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏—Ö –∑–∞–¥–∞—á–∞—Ö
- **Sessions** - —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω stateful –ø—ñ–¥—Ö—ñ–¥ (—Ä—ñ–¥–∫–æ –¥–ª—è REST API)

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è

**–î–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É –∑–∞–ª–∏—à–∞—î–º–æ —è–∫ —î:**
- JWT —Ç–æ–∫–µ–Ω–∏ –≤ Authorization header
- PostgreSQL –¥–ª—è –¥–∞–Ω–∏—Ö
- Observer pattern –¥–ª—è —Å–ø–æ–≤—ñ—â–µ–Ω—å

**–ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ø—ñ–∑–Ω—ñ—à–µ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ):**
- –ü—Ä–æ—Å—Ç–∏–π rate limiting (–±–µ–∑ Redis)
- HttpOnly cookies (–¥–ª—è –±–µ–∑–ø–µ–∫–∏)

**–ù–µ –¥–æ–¥–∞—î–º–æ:**
- Redis (–Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–ª—è –∫—É—Ä—Å–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É)
- RabbitMQ (overkill)
- Sessions (JWT –∫—Ä–∞—â–µ –¥–ª—è REST API)

